{"ast":null,"code":"import React,{useState}from'react';import{createPortal}from'react-dom';import Badge from'../Badge/Badge';import{supabase}from'../../utils/supabaseClient';import styles from'./FeedbackModal.module.scss';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const FeedbackModal=_ref=>{let{isOpen,onClose,onSubmit,sessionDurationSeconds}=_ref;const[selectedOptions,setSelectedOptions]=useState([]);const[feedbackText,setFeedbackText]=useState('');const[isLoading,setIsLoading]=useState(false);const[submitError,setSubmitError]=useState(null);const options=[\"Нет релевантного опыта\",\"Нехватило описания кейсов\",\"Слабая преза\",\"Все супер\"];const toggleOption=option=>{if(selectedOptions.includes(option)){setSelectedOptions(selectedOptions.filter(item=>item!==option));}else{setSelectedOptions([...selectedOptions,option]);}};const handleSubmit=async()=>{// Проверяем, что хотя бы одно из полей заполнено\nif(!selectedOptions.length&&!feedbackText.trim()){setSubmitError('Пожалуйста, выберите хотя бы один вариант или введите текст отзыва');return;}setIsLoading(true);setSubmitError(null);try{// Отправляем данные в Supabase\nconst{error}=await supabase.from('exit_feedback').insert([{options:selectedOptions,feedback_text:feedbackText,page_url:window.location.href,user_agent:navigator.userAgent,session_duration_seconds:sessionDurationSeconds||0}]);if(error){console.error('Error saving feedback:',error);setSubmitError('Ошибка при отправке обратной связи. Пожалуйста, попробуйте еще раз.');}else{// Успешно отправлено\nonSubmit({options:selectedOptions,feedback:feedbackText});onClose();}}catch(error){console.error('Error saving feedback:',error);setSubmitError('Ошибка при отправке обратной связи. Пожалуйста, попробуйте еще раз.');}finally{setIsLoading(false);}};if(!isOpen)return null;const modalRoot=document.getElementById('modal-root');if(!modalRoot){console.error('Modal root element not found');return null;}return/*#__PURE__*/createPortal(/*#__PURE__*/_jsx(\"div\",{className:styles.feedbackModalOverlay,children:/*#__PURE__*/_jsxs(\"div\",{className:styles.feedbackModal,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.feedbackModalHeader,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u041D\\u0435 \\u0437\\u0430\\u0446\\u0435\\u043F\\u0438\\u043B? \\u041F\\u043E\\u043C\\u043E\\u0433\\u0438 \\u043C\\u043D\\u0435 \\u0441\\u0442\\u0430\\u0442\\u044C \\u043B\\u0443\\u0447\\u0448\\u0435\"}),/*#__PURE__*/_jsx(\"button\",{className:styles.feedbackModalClose,onClick:onClose,children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.feedbackModalContent,children:[/*#__PURE__*/_jsx(\"div\",{className:styles.feedbackOptions,children:options.map((option,index)=>/*#__PURE__*/_jsx(Badge,{variant:selectedOptions.includes(option)?'primary':'default',size:\"large\",onClick:()=>toggleOption(option),className:\"\".concat(styles.feedbackBadge,\" \").concat(selectedOptions.includes(option)?styles.selected:''),children:option},index))}),/*#__PURE__*/_jsx(\"div\",{className:styles.feedbackTextarea,children:/*#__PURE__*/_jsx(\"textarea\",{value:feedbackText,onChange:e=>setFeedbackText(e.target.value),placeholder:\"\\u041F\\u0430\\u0440\\u0430 \\u0441\\u043B\\u043E\\u0432, \\u0447\\u0442\\u043E \\u043C\\u043E\\u0436\\u043D\\u043E \\u0443\\u043B\\u0443\\u0447\\u0448\\u0438\\u0442\\u044C\",className:styles.feedbackInput})}),submitError&&/*#__PURE__*/_jsx(\"div\",{className:styles.feedbackError,children:submitError}),/*#__PURE__*/_jsx(\"button\",{className:styles.feedbackSubmitButton,onClick:handleSubmit,disabled:!selectedOptions.length&&!feedbackText.trim()||isLoading,children:isLoading?'Отправка...':'Отправить'})]})]})}),modalRoot);};export default FeedbackModal;","map":{"version":3,"names":["React","useState","createPortal","Badge","supabase","styles","jsx","_jsx","jsxs","_jsxs","FeedbackModal","_ref","isOpen","onClose","onSubmit","sessionDurationSeconds","selectedOptions","setSelectedOptions","feedbackText","setFeedbackText","isLoading","setIsLoading","submitError","setSubmitError","options","toggleOption","option","includes","filter","item","handleSubmit","length","trim","error","from","insert","feedback_text","page_url","window","location","href","user_agent","navigator","userAgent","session_duration_seconds","console","feedback","modalRoot","document","getElementById","className","feedbackModalOverlay","children","feedbackModal","feedbackModalHeader","feedbackModalClose","onClick","feedbackModalContent","feedbackOptions","map","index","variant","size","concat","feedbackBadge","selected","feedbackTextarea","value","onChange","e","target","placeholder","feedbackInput","feedbackError","feedbackSubmitButton","disabled"],"sources":["/Users/alex/Documents/Github/Portfolio/src/Components/FeedbackModal/FeedbackModal.jsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { createPortal } from 'react-dom';\nimport Badge from '../Badge/Badge';\nimport { supabase } from '../../utils/supabaseClient';\nimport styles from './FeedbackModal.module.scss';\n\nconst FeedbackModal = ({ isOpen, onClose, onSubmit, sessionDurationSeconds }) => {\n  const [selectedOptions, setSelectedOptions] = useState([]);\n  const [feedbackText, setFeedbackText] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [submitError, setSubmitError] = useState(null);\n\n  const options = [\n    \"Нет релевантного опыта\",\n    \"Нехватило описания кейсов\",\n    \"Слабая преза\",\n    \"Все супер\"\n  ];\n\n  const toggleOption = (option) => {\n    if (selectedOptions.includes(option)) {\n      setSelectedOptions(selectedOptions.filter(item => item !== option));\n    } else {\n      setSelectedOptions([...selectedOptions, option]);\n    }\n  };\n\n  const handleSubmit = async () => {\n    // Проверяем, что хотя бы одно из полей заполнено\n    if (!selectedOptions.length && !feedbackText.trim()) {\n      setSubmitError('Пожалуйста, выберите хотя бы один вариант или введите текст отзыва');\n      return;\n    }\n    \n    setIsLoading(true);\n    setSubmitError(null);\n    \n    try {\n      // Отправляем данные в Supabase\n      const { error } = await supabase\n        .from('exit_feedback')\n        .insert([{\n          options: selectedOptions,\n          feedback_text: feedbackText,\n          page_url: window.location.href,\n          user_agent: navigator.userAgent,\n          session_duration_seconds: sessionDurationSeconds || 0\n        }]);\n\n      if (error) {\n        console.error('Error saving feedback:', error);\n        setSubmitError('Ошибка при отправке обратной связи. Пожалуйста, попробуйте еще раз.');\n      } else {\n        // Успешно отправлено\n        onSubmit({\n          options: selectedOptions,\n          feedback: feedbackText\n        });\n        onClose();\n      }\n    } catch (error) {\n      console.error('Error saving feedback:', error);\n      setSubmitError('Ошибка при отправке обратной связи. Пожалуйста, попробуйте еще раз.');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  if (!isOpen) return null;\n\n  const modalRoot = document.getElementById('modal-root');\n  \n  if (!modalRoot) {\n    console.error('Modal root element not found');\n    return null;\n }\n\n  return createPortal(\n    <div className={styles.feedbackModalOverlay}>\n      <div className={styles.feedbackModal}>\n        <div className={styles.feedbackModalHeader}>\n          <h2>Не зацепил? Помоги мне стать лучше</h2>\n          <button className={styles.feedbackModalClose} onClick={onClose}>×</button>\n        </div>\n        \n        <div className={styles.feedbackModalContent}>\n          <div className={styles.feedbackOptions}>\n            {options.map((option, index) => (\n              <Badge\n                key={index}\n                variant={selectedOptions.includes(option) ? 'primary' : 'default'}\n                size=\"large\"\n                onClick={() => toggleOption(option)}\n                className={`${styles.feedbackBadge} ${selectedOptions.includes(option) ? styles.selected : ''}`}\n              >\n                {option}\n              </Badge>\n            ))}\n          </div>\n          \n          <div className={styles.feedbackTextarea}>\n            <textarea\n              value={feedbackText}\n              onChange={(e) => setFeedbackText(e.target.value)}\n              placeholder=\"Пара слов, что можно улучшить\"\n              className={styles.feedbackInput}\n            />\n          </div>\n          \n          {submitError && (\n            <div className={styles.feedbackError}>\n              {submitError}\n            </div>\n          )}\n          <button\n            className={styles.feedbackSubmitButton}\n            onClick={handleSubmit}\n            disabled={(!selectedOptions.length && !feedbackText.trim()) || isLoading}\n          >\n\n            {isLoading ? 'Отправка...' : 'Отправить'}\n          </button>\n        </div>\n      </div>\n    </div>,\n    modalRoot\n );\n};\n\nexport default FeedbackModal;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}